"use strict";(self.webpackChunkpiperider_report=self.webpackChunkpiperider_report||[]).push([[42],{5042:function(e,n,i){i.r(n),i.d(n,{default:function(){return U}});var s=i(1413),t=i(2982),l=i(885),d=i(5223),o=i(8735),r=i(6837),a=i(8625),c=i(2791),u=i(3853),v=i(2010),x=i(6157),j=i(2483),h=i(5987),m=i(8540),p=i(2504),f=i(7005),g=i(2387),T=i(5484),y=i(184);function b(e){var n,i,s,t,l,d,o=e.data;return(0,y.jsx)(f.xJ,{children:(0,y.jsxs)(f.iA,{variant:"simple",children:[(0,y.jsx)(f.hr,{children:(0,y.jsxs)(f.Tr,{children:[(0,y.jsx)(f.Th,{}),(0,y.jsx)(f.Th,{children:"Status"}),(0,y.jsx)(f.Th,{children:"Message"})]})}),(0,y.jsxs)(f.p3,{children:[(0,y.jsxs)(f.Tr,{children:[(0,y.jsx)(f.Td,{fontWeight:700,children:"Base"}),(0,y.jsx)(f.Td,{children:(0,y.jsx)(T.s,{status:null===o||void 0===o||null===(n=o.base)||void 0===n?void 0:n.status})}),(0,y.jsx)(f.Td,{children:null!==(i=null===o||void 0===o||null===(s=o.base)||void 0===s?void 0:s.message)&&void 0!==i?i:g.Nj})]}),(0,y.jsxs)(f.Tr,{children:[(0,y.jsx)(f.Td,{fontWeight:700,children:"Target"}),(0,y.jsx)(f.Td,{children:(0,y.jsx)(T.s,{status:null===o||void 0===o||null===(t=o.target)||void 0===t?void 0:t.status})}),(0,y.jsx)(f.Td,{children:null!==(l=null===o||void 0===o||null===(d=o.base)||void 0===d?void 0:d.message)&&void 0!==l?l:g.Nj})]})]})]})})}var S=i(709);function C(e){var n,i,s,t,l,d,o=e.data;return(0,y.jsx)(f.xJ,{children:(0,y.jsxs)(f.iA,{variant:"simple",children:[(0,y.jsx)(f.hr,{children:(0,y.jsxs)(f.Tr,{children:[(0,y.jsx)(f.Th,{}),(0,y.jsx)(f.Th,{children:"Status"}),(0,y.jsx)(f.Th,{children:"Expected"}),(0,y.jsx)(f.Th,{children:"Actual"})]})}),(0,y.jsxs)(f.p3,{children:[(0,y.jsxs)(f.Tr,{children:[(0,y.jsx)(f.Td,{fontWeight:700,children:"Base"}),(0,y.jsx)(f.Td,{children:(0,y.jsx)(T.s,{status:null===o||void 0===o||null===(n=o.base)||void 0===n?void 0:n.status})}),(0,y.jsx)(f.Td,{children:(0,S.sG)(null===o||void 0===o||null===(i=o.base)||void 0===i?void 0:i.expected)}),(0,y.jsx)(f.Td,{children:(0,S.sG)(null===o||void 0===o||null===(s=o.base)||void 0===s?void 0:s.actual)})]}),(0,y.jsxs)(f.Tr,{children:[(0,y.jsx)(f.Td,{fontWeight:700,children:"Target"}),(0,y.jsx)(f.Td,{children:(0,y.jsx)(T.s,{status:null===o||void 0===o||null===(t=o.target)||void 0===t?void 0:t.status})}),(0,y.jsx)(f.Td,{children:(0,S.sG)(null===o||void 0===o||null===(l=o.target)||void 0===l?void 0:l.expected)}),(0,y.jsx)(f.Td,{children:(0,S.sG)(null===o||void 0===o||null===(d=o.target)||void 0===d?void 0:d.actual)})]})]})]})})}var k=["data","type","isOpen","onClose"];function Z(e){var n=e.data,i=e.type,t=void 0===i?"piperider":i,l=e.isOpen,d=e.onClose,r=(0,h.Z)(e,k);return(0,y.jsxs)(m.u_,(0,s.Z)((0,s.Z)({},r),{},{isOpen:l,size:"2xl",onClose:function(){d()},children:[(0,y.jsx)(m.ZA,{}),(0,y.jsxs)(m.hz,{children:[(0,y.jsx)(m.xB,{children:(0,y.jsx)(o.xv,{title:null===n||void 0===n?void 0:n.name,noOfLines:1,maxWidth:"calc(100% - 50px)",children:null===n||void 0===n?void 0:n.name})}),(0,y.jsx)(m.ol,{}),(0,y.jsx)(m.fe,{children:"piperider"===t?(0,y.jsx)(C,{data:n}):(0,y.jsx)(b,{data:n})}),(0,y.jsx)(m.mz,{children:(0,y.jsx)(p.zx,{onClick:d,children:"Close"})})]})]}))}var N=i(6523),J=i(429),A=i(2296),O=i(5147),w=i(6983),P=i(2220),W=i(2196);function z(e){var n=e.name,i=e.firstSlot,s=e.secondSlot,t=e.firstSlotWidth,l=void 0===t?"100px":t,d=e.secondSlotWidth,r=void 0===d?"100px":d,a=e.metakey,c=W.d[a||""];return(0,y.jsxs)(o.kC,{children:[(0,y.jsx)(P.u,{label:c,isDisabled:!Boolean(c),placement:"top",children:(0,y.jsx)(o.xv,{width:"5em",fontWeight:700,children:n})}),(0,y.jsxs)(o.kC,{gap:{lg:5,md:1},children:[(0,y.jsx)(o.xv,{textAlign:"right",width:l,noOfLines:1,children:i}),s&&(0,y.jsx)(o.xv,{textAlign:"right",width:r,children:s})]})]})}function D(e){var n=e.baseColumn,i=e.targetColumn;if(n){(0,N.h5)(N.a$.safeParse(n));var s=n.nulls,t=n.total,l=n.valids,d=n.invalids,o=(0,J.gQ)(n),r=o.totalOfTotal,a=o.distinctOfTotal,c=o.invalidsOfTotal,u=o.validsOfTotal,v=o.nullsOfTotal}if(i){var x=i.total;N.a$.parse(i);var j=(0,J.gQ)(i),h=j.invalidsOfTotal,m=j.distinctOfTotal,p=j.validsOfTotal,f=j.nullsOfTotal}var T=null===i;return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(z,{name:"Total",metakey:"total",firstSlot:(0,S.uy)(t,S.uf),secondSlot:T?g.Nj:(0,S.uy)(i?x:r,i?S.uf:S.Zn)}),(0,y.jsx)(z,{name:"Valid",metakey:"valids",firstSlot:(0,S.uy)(i?u:l,i?S.Zn:S.uf),secondSlot:T?g.Nj:(0,S.uy)(i?p:u,S.Zn)}),(0,y.jsx)(z,{name:"Invalid",metakey:"invalids",firstSlot:(0,S.uy)(i?c:d,i?S.Zn:S.uf),secondSlot:T?g.Nj:(0,S.uy)(i?h:c,S.Zn)}),(0,y.jsx)(z,{name:"Missing",metakey:"nulls",firstSlot:(0,S.uy)(i?v:s,i?S.Zn:S.uf),secondSlot:T?g.Nj:(0,S.uy)(i?f:v,S.Zn)}),(0,y.jsx)(z,{name:"Distinct",metakey:"distinct",firstSlot:(0,S.uy)(a,S.Zn),secondSlot:T?g.Nj:(0,S.uy)(i?m:a,S.Zn)})]})}function I(e){var n=e.baseColumn,i=e.targetColumn,s=null===i,t=void 0===i;return(0,N.h5)(N.a$.safeParse(n)),(0,N.h5)(N.a$.safeParse(n)),(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(o.kC,{direction:"column",children:[(0,y.jsx)(z,{name:"Average",metakey:"avg",firstSlot:(0,S.uy)(null===n||void 0===n?void 0:n.avg,S.J8),secondSlot:s?g.Nj:t?void 0:(0,S.uy)(null===i||void 0===i?void 0:i.avg,S.J8)}),(0,y.jsx)(z,{name:"SD",metakey:"stddev",firstSlot:(0,S.uy)(null===n||void 0===n?void 0:n.stddev,S.J8),secondSlot:s?g.Nj:t?void 0:(0,S.uy)(null===i||void 0===i?void 0:i.stddev,S.J8)})]}),(0,y.jsxs)(o.kC,{direction:"column",children:[(0,y.jsx)(z,{name:"Min",metakey:"min",firstSlot:(0,S.uy)(null===n||void 0===n?void 0:n.min,S.J8),secondSlot:s?g.Nj:t?void 0:(0,S.uy)(null===i||void 0===i?void 0:i.min,S.J8)}),(0,y.jsx)(z,{name:"5%",metakey:"p5",firstSlot:(0,S.uy)(null===n||void 0===n?void 0:n.p5,S.J8),secondSlot:s?g.Nj:t?void 0:(0,S.uy)(null===i||void 0===i?void 0:i.p5,S.J8)}),(0,y.jsx)(z,{name:"25%",metakey:"p25",firstSlot:(0,S.uy)(null===n||void 0===n?void 0:n.p25,S.J8),secondSlot:s?g.Nj:t?void 0:(0,S.uy)(null===i||void 0===i?void 0:i.p25,S.J8)}),(0,y.jsx)(z,{name:"50%",metakey:"p50",firstSlot:(0,S.uy)(null===n||void 0===n?void 0:n.p50,S.J8),secondSlot:s?g.Nj:t?void 0:(0,S.uy)(null===i||void 0===i?void 0:i.p50,S.J8)}),(0,y.jsx)(z,{name:"75%",metakey:"p75",firstSlot:(0,S.uy)(null===n||void 0===n?void 0:n.p75,S.J8),secondSlot:s?g.Nj:t?void 0:(0,S.uy)(null===i||void 0===i?void 0:i.p75,S.J8)}),(0,y.jsx)(z,{name:"95%",metakey:"p95",firstSlot:(0,S.uy)(null===n||void 0===n?void 0:n.p95,S.J8),secondSlot:s?g.Nj:t?void 0:(0,S.uy)(null===i||void 0===i?void 0:i.p95,S.J8)}),(0,y.jsx)(z,{name:"Max",metakey:"max",firstSlot:(0,S.uy)(null===n||void 0===n?void 0:n.max,S.J8),secondSlot:s?g.Nj:t?void 0:(0,S.uy)(null===i||void 0===i?void 0:i.max,S.J8)})]})]})}var _=function(e){var n,i,s,t,l,d,r,a,c=e.baseColumn,u=e.targetColumn,v=c||u,x=(0,J.JH)(c);return(0,N.h5)(N.a$.safeParse(c)),(0,N.h5)(N.a$.safeParse(u)),(0,y.jsxs)(o.kC,{direction:"column",gap:2,minH:"250px",border:"1px solid darkgray",rounded:"2xl",children:[v&&(0,y.jsx)(w.f,{columnDatum:v}),(0,y.jsxs)(o.kC,{direction:"column",gap:3,m:4,children:[(0,y.jsxs)(o.kC,{gap:8,children:[(0,y.jsx)(o.xv,{ml:"16",fontWeight:700,textAlign:"right",width:"100px",children:"Base"}),(0,y.jsx)(o.xv,{fontWeight:700,textAlign:"right",width:"100px",children:"Target"})]}),(0,y.jsx)(o.kC,{direction:"column",mt:3,children:(0,y.jsx)(D,{baseColumn:c,targetColumn:u||null})}),"numeric"===(null===c||void 0===c?void 0:c.type)&&(0,y.jsx)(I,{baseColumn:c,targetColumn:u||null}),"datetime"===(null===c||void 0===c?void 0:c.type)&&(0,y.jsxs)(o.kC,{direction:"column",children:[(0,y.jsx)(z,{name:"Min",metakey:"min",firstSlot:null!==(n=(0,S.p6)(String(null===c||void 0===c?void 0:c.min)))&&void 0!==n?n:g.Nj,secondSlot:null!==(i=(0,S.p6)(String(null===u||void 0===u?void 0:u.min)))&&void 0!==i?i:g.Nj}),(0,y.jsx)(z,{name:"Max",metakey:"max",firstSlot:null!==(s=(0,S.p6)(String(null===c||void 0===c?void 0:c.max)))&&void 0!==s?s:g.Nj,secondSlot:null!==(t=(0,S.p6)(String(null===u||void 0===u?void 0:u.max)))&&void 0!==t?t:g.Nj})]}),x&&(0,y.jsx)(o.kC,{direction:"column",children:(0,y.jsx)(z,{name:"Most Common",metakey:"topk",firstSlot:null!==(l=String(null===c||void 0===c||null===(d=c.topk)||void 0===d?void 0:d.values[0]))&&void 0!==l?l:g.Nj,secondSlot:null!==(r=String(null===u||void 0===u||null===(a=u.topk)||void 0===a?void 0:a.values[0]))&&void 0!==r?r:g.Nj})})]})]})};function M(e){var n=e.baseTable,i=e.targetTable;(0,N.h5)(N.vT.safeParse(n)),(0,N.h5)(N.vT.safeParse(i));var s=(0,J.WN)(null===n||void 0===n?void 0:n.columns,null===i||void 0===i?void 0:i.columns);return(0,y.jsx)(y.Fragment,{children:Object.entries(s).map((function(e){var n=(0,l.Z)(e,2),i=n[0],s=n[1];return(0,y.jsx)(R,{name:i,base:null===s||void 0===s?void 0:s.base,target:null===s||void 0===s?void 0:s.target},i)}))})}function R(e){var n=e.name,i=e.base,s=e.target;return(0,y.jsx)(o.kC,{direction:"column",children:(0,y.jsxs)(o.rj,{my:8,templateColumns:"400px 1fr",gap:12,overflowX:"hidden",children:[(0,y.jsx)(_,{baseColumn:i,targetColumn:s}),(0,y.jsxs)(o.kC,{my:4,alignItems:"center",children:[(0,y.jsx)(O.T,{height:350,children:i?(0,A.S)(i):(0,y.jsx)(B,{})}),(0,y.jsx)(O.T,{height:350,children:s?(0,A.S)(s,i):(0,y.jsx)(B,{})})]})]})},n)}function B(){return(0,y.jsx)(o.kC,{alignItems:"center",justifyContent:"center",color:"gray.500",children:"No data available"})}var G=i(8444),V=i.n(G),$=i(5984),H=["assertions"];function X(e){return Object.values(e).map((function(e){var n={name:e[0].name};return e.forEach((function(e){"base"===e.from?n.base=e:n.target=e})),n}))}function F(e){var n=e.assertions,i=(0,h.Z)(e,H),s=n.piperider,l=n.dbt,d=V()(s,(function(e){return"".concat(e.level,"_").concat(e.column,"_").concat(e.name)})),r=V()(l,(function(e){return"".concat(e.level,"_").concat(e.column,"_").concat(e.name)})),a=X(d),c=X(r),u=function(e,n){var i=e.reduce((function(e,n){return E("PipeRider",n,e)}),{passed:[],failed:[]}),s=i.passed,l=i.failed,d=n.reduce((function(e,n){return E("dbt",n,e)}),{passed:[],failed:[]}),o=d.passed,r=d.failed;return{passedAssertionRows:[].concat((0,t.Z)(s),(0,t.Z)(o)),failedAssertionRows:[].concat((0,t.Z)(l),(0,t.Z)(r))}}(a,c),v=u.passedAssertionRows,x=u.failedAssertionRows;return 0===a.length&&0===c.length?(0,y.jsx)(o.kC,{direction:"column",justifyContent:"center",alignItems:"center",children:(0,y.jsx)(o.xv,{textAlign:"center",children:"No tests available"})}):(0,y.jsx)(f.xJ,{children:(0,y.jsxs)(f.iA,{variant:"simple",children:[(0,y.jsx)(f.hr,{children:(0,y.jsxs)(f.Tr,{children:[(0,y.jsx)(f.Th,{children:"Assertion"}),(0,y.jsx)(f.Th,{children:"Base Status"}),(0,y.jsx)(f.Th,{children:"Target Status"}),(0,y.jsx)(f.Th,{children:"Source"}),(0,y.jsx)(f.Th,{})]})}),(0,y.jsxs)(f.p3,{children:[x.map((function(e){var n,s;return(0,y.jsxs)(f.Tr,{children:[(0,y.jsx)(f.Td,{children:e.name}),(0,y.jsx)(f.Td,{children:(0,y.jsx)(T.s,{status:null===(n=e.base)||void 0===n?void 0:n.status})}),(0,y.jsx)(f.Td,{children:(0,y.jsx)(T.s,{status:null===(s=e.target)||void 0===s?void 0:s.status})}),(0,y.jsx)(f.Td,{children:e.source}),(0,y.jsx)(f.Td,{onClick:function(){i.onDetailVisible({type:"piperider",data:e})},children:(0,y.jsx)(o.xv,{as:"span",cursor:"pointer",children:"\ud83d\udd0d"})})]},(0,$.x0)())})),v.map((function(e){var n,s;return(0,y.jsxs)(f.Tr,{children:[(0,y.jsx)(f.Td,{children:e.name}),(0,y.jsx)(f.Td,{children:(0,y.jsx)(T.s,{status:null===(n=e.base)||void 0===n?void 0:n.status})}),(0,y.jsx)(f.Td,{children:(0,y.jsx)(T.s,{status:null===(s=e.target)||void 0===s?void 0:s.status})}),(0,y.jsx)(f.Td,{children:e.source}),(0,y.jsx)(f.Td,{onClick:function(){i.onDetailVisible({type:"piperider",data:e})},children:(0,y.jsx)(o.xv,{as:"span",cursor:"pointer",children:"\ud83d\udd0d"})})]},(0,$.x0)())}))]})]})})}function E(e,n,i){var t,l;n&&("failed"===(null===(t=n.base)||void 0===t?void 0:t.status)||"failed"===(null===(l=n.target)||void 0===l?void 0:l.status)?i.failed.push((0,s.Z)((0,s.Z)({},n),{},{source:e})):i.passed.push((0,s.Z)((0,s.Z)({},n),{},{source:e})));return i}var L=i(9113);function Q(e){var n=e.baseTable,i=e.targetTable;return(0,N.h5)(N.vT.safeParse(n)),(0,N.h5)(N.vT.safeParse(i)),(0,y.jsxs)(o.kC,{gap:1,direction:"column",mb:8,children:[(0,y.jsx)(o.xv,{color:"gray.500",children:"Table"}),(0,y.jsx)(o.X6,{fontSize:24,children:(0,y.jsxs)(o.kC,{alignItems:"center",children:[(0,y.jsx)(L.JO,{as:u.aCJ,mr:1}),null===i||void 0===i?void 0:i.name]})}),(0,y.jsx)(o.xv,{fontSize:"sm",children:null===i||void 0===i?void 0:i.description})]})}var q=i(6646);function U(e){var n=e.data,i=e.name,h=(0,c.useState)(null),m=(0,l.Z)(h,2),p=m[0],f=m[1],g=(0,d.qY)(),T=(0,c.useState)(!1),b=(0,l.Z)(T,2),C=b[0],k=b[1],J=(0,c.useState)(!1),A=(0,l.Z)(J,2),O=A[0],w=A[1],P=n.base,W=n.input;(0,N.h5)((0,N.C6)(!0).safeParse(n));var z=P.tables[i],D=W.tables[i];(0,N.h5)(N.vT.safeParse(z)),(0,N.h5)(N.vT.safeParse(D));var I=(0,x.Ix)({data:n,reportName:i,type:"piperider"}),_=(0,l.Z)(I,2),R=_[0],B=_[1],G=(0,x.Ix)({data:n,reportName:i,type:"dbt"}),V=(0,l.Z)(G,2),$=V[0],H=V[1],X=[].concat((0,t.Z)((null===R||void 0===R?void 0:R.tests)||[]),(0,t.Z)((null===B||void 0===B?void 0:B.tests)||[])),E=[].concat((0,t.Z)((null===$||void 0===$?void 0:$.tests)||[]),(0,t.Z)((null===H||void 0===H?void 0:H.tests)||[])),L=0===X.length&&0===E.length;return(0,j.j)(i),(0,y.jsxs)(v.o,{isSingleReport:!1,time:"".concat((0,S.D8)(P.created_at)," -> ").concat((0,S.D8)(W.created_at)),children:[(0,y.jsxs)(o.kC,{direction:"column",minH:"calc(100vh + 1px)",width:"inherit",children:[(0,y.jsx)(o.kC,{mx:"5%",mt:4,children:(0,y.jsxs)(r.aG,{fontSize:"lg",children:[(0,y.jsx)(r.gN,{children:(0,y.jsx)(a.rU,{href:"/",children:(0,y.jsx)(r.At,{href:"/","data-cy":"cr-report-breadcrumb-back",children:(0,y.jsxs)(o.kC,{alignItems:"center",gap:1,children:[(0,y.jsx)(u.bGz,{})," Tables"]})})})}),(0,y.jsx)(r.gN,{isCurrentPage:!0,children:(0,y.jsx)(r.At,{href:"#",children:(0,y.jsxs)(o.kC,{alignItems:"center",gap:1,children:[(0,y.jsx)(u.aCJ,{}),i]})})})]})}),(0,y.jsxs)(o.kC,{border:"1px solid",borderColor:"gray.300",bg:"white",borderRadius:"md",p:6,mt:3,mx:"5%",direction:"column",children:[(0,y.jsx)(Q,{baseTable:z,targetTable:D}),(0,y.jsx)(o.X6,{size:"md",children:"Assertions"}),(0,y.jsx)(q.S,{in:C,startingHeight:L?50:250,collapseable:!L,onVisible:function(){return k((function(e){return!e}))},children:(0,y.jsx)(F,{assertions:{piperider:X,dbt:E},onDetailVisible:function(e){var n=e.data,i=e.type;f({type:i,data:n}),g.onOpen()}})}),(0,y.jsx)(o.X6,{size:"md",mt:4,children:"Columns"}),(0,y.jsx)(q.S,{in:O,startingHeight:void 0===z&&void 0===D?50:350,collapseable:void 0!==z||void 0!==D,onVisible:function(){return w((function(e){return!e}))},children:(0,y.jsx)(M,{baseTable:z,targetTable:D})})]})]}),(0,y.jsx)(Z,(0,s.Z)((0,s.Z)({},g),{},{type:null===p||void 0===p?void 0:p.type,data:null===p||void 0===p?void 0:p.data,onClose:function(){g.onClose(),f(null)}}))]})}}}]);
//# sourceMappingURL=42.cd4b9fbe.chunk.js.map