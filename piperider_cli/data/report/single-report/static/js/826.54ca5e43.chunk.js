"use strict";(self.webpackChunkpiperider_report=self.webpackChunkpiperider_report||[]).push([[826],{5826:function(e,n,t){t.r(n),t.d(n,{default:function(){return H}});var i=t(1413),l=t(885),r=t(5223),s=t(8735),a=t(6837),o=t(4385),d=t(8625),c=t(2791),u=t(8011),v=t(6157),h=t(2483),x=t(3442),f=t(5987),j=t(1564),m=t(2504),p=t(7005),g=t(184);function b(e){switch(e.status){case"passed":return(0,g.jsx)(s.xv,{as:"span",role:"img",children:"\u2705"});case"failed":return(0,g.jsx)(s.xv,{as:"span",role:"img",children:"\u274c"});default:return(0,g.jsx)(s.xv,{as:"span",role:"img",children:"-"})}}function T(e){var n,t,i,l,r,s,a=e.data;return(0,g.jsx)(p.xJ,{children:(0,g.jsxs)(p.iA,{variant:"simple",children:[(0,g.jsx)(p.hr,{children:(0,g.jsxs)(p.Tr,{children:[(0,g.jsx)(p.Th,{}),(0,g.jsx)(p.Th,{children:"Status"}),(0,g.jsx)(p.Th,{children:"Message"})]})}),(0,g.jsxs)(p.p3,{children:[(0,g.jsxs)(p.Tr,{children:[(0,g.jsx)(p.Td,{fontWeight:700,children:"Base"}),(0,g.jsx)(p.Td,{children:(0,g.jsx)(b,{status:null===a||void 0===a||null===(n=a.base)||void 0===n?void 0:n.status})}),(0,g.jsx)(p.Td,{children:null!==(t=null===a||void 0===a||null===(i=a.base)||void 0===i?void 0:i.message)&&void 0!==t?t:"-"})]}),(0,g.jsxs)(p.Tr,{children:[(0,g.jsx)(p.Td,{fontWeight:700,children:"Target"}),(0,g.jsx)(p.Td,{children:(0,g.jsx)(b,{status:null===a||void 0===a||null===(l=a.target)||void 0===l?void 0:l.status})}),(0,g.jsx)(p.Td,{children:null!==(r=null===a||void 0===a||null===(s=a.base)||void 0===s?void 0:s.message)&&void 0!==r?r:"-"})]})]})]})})}var y=t(1971);function C(e){var n,t,i,l,r,s,a=e.data;return(0,g.jsx)(p.xJ,{children:(0,g.jsxs)(p.iA,{variant:"simple",children:[(0,g.jsx)(p.hr,{children:(0,g.jsxs)(p.Tr,{children:[(0,g.jsx)(p.Th,{}),(0,g.jsx)(p.Th,{children:"Status"}),(0,g.jsx)(p.Th,{children:"Expected"}),(0,g.jsx)(p.Th,{children:"Actual"})]})}),(0,g.jsxs)(p.p3,{children:[(0,g.jsxs)(p.Tr,{children:[(0,g.jsx)(p.Td,{fontWeight:700,children:"Base"}),(0,g.jsx)(p.Td,{children:(0,g.jsx)(b,{status:null===a||void 0===a||null===(n=a.base)||void 0===n?void 0:n.status})}),(0,g.jsx)(p.Td,{children:(0,y.sG)(null===a||void 0===a||null===(t=a.base)||void 0===t?void 0:t.expected)}),(0,g.jsx)(p.Td,{children:(0,y.sG)(null===a||void 0===a||null===(i=a.base)||void 0===i?void 0:i.actual)})]}),(0,g.jsxs)(p.Tr,{children:[(0,g.jsx)(p.Td,{fontWeight:700,children:"Target"}),(0,g.jsx)(p.Td,{children:(0,g.jsx)(b,{status:null===a||void 0===a||null===(l=a.target)||void 0===l?void 0:l.status})}),(0,g.jsx)(p.Td,{children:(0,y.sG)(null===a||void 0===a||null===(r=a.target)||void 0===r?void 0:r.expected)}),(0,g.jsx)(p.Td,{children:(0,y.sG)(null===a||void 0===a||null===(s=a.target)||void 0===s?void 0:s.actual)})]})]})]})})}var k=["data","type","isOpen","onClose"];function S(e){var n=e.data,t=e.type,l=void 0===t?"piperider":t,r=e.isOpen,a=e.onClose,o=(0,f.Z)(e,k);return(0,g.jsxs)(j.u_,(0,i.Z)((0,i.Z)({},o),{},{isOpen:r,size:"2xl",onClose:function(){a()},children:[(0,g.jsx)(j.ZA,{}),(0,g.jsxs)(j.hz,{children:[(0,g.jsx)(j.xB,{children:(0,g.jsx)(s.xv,{title:null===n||void 0===n?void 0:n.name,noOfLines:1,maxWidth:"calc(100% - 50px)",children:null===n||void 0===n?void 0:n.name})}),(0,g.jsx)(j.ol,{}),(0,g.jsx)(j.fe,{children:"piperider"===l?(0,g.jsx)(C,{data:n}):(0,g.jsx)(T,{data:n})}),(0,g.jsx)(j.mz,{children:(0,g.jsx)(m.zx,{onClick:a,children:"Close"})})]})]}))}var Z=t(6523),_=t(922),O=t(8453),P=t(9227),w=t(9842),A=["base","target"];function W(e){var n=e.data,t=(0,c.useRef)(null),i=(0,c.useRef)(null);return function(e){var n=e.target,t=e.data,i=e.dimensions;(0,c.useEffect)((function(){if(n&&i&&t){var e=P.Ys(n.current),l=t.map((function(e){return e.label||""})),r=P.tiA().domain(l).range([0,i.width]).padding(.2),s=P.tiA().domain(A).range([0,r.bandwidth()]).padding(.05),a=P.LLu(r).tickFormat((function(e,n){var t=r.domain().length-1;return 0===n||n===t/2||n===t?e:""}));e.select(".x-axis").style("transform","translateY(".concat(i.height,"px)")).call(a);var o=P.BYU().domain([0,P.Fp7(t,(function(e){var n=e.base,t=e.target;return Math.max(n,t)}))]).range([i.height,0]),d=P.y4O(o);e.select(".y-axis").call(d);var c=P.PKp().domain(A).range(["var(--chakra-colors-blue-100)","var(--chakra-colors-blue-300)"]),u=e.selectAll(".grouped-chart").data(t).join("g").attr("class","grouped-chart").attr("transform",(function(e){return"translate(".concat(r(e.label),", 0)")})),v=(0,w.v)({target:".chart"});return u.selectAll("rect").data((function(e){return A.map((function(n){return{key:n,label:e.label,value:e[n]}}))})).enter().append("rect").attr("x",(function(e){return s(e.key)})).attr("y",(function(e){return o(e.value)})).attr("width",(function(e){return s.bandwidth()})).attr("height",(function(e){return i.height-o(e.value)})).attr("fill",(function(e){return c(e.key)})),u.selectAll(".overlay-bars").data((function(e){return A.map((function(n){return{key:n,label:e.label,value:e[n]}}))})).join("rect").attr("class","overlay-bars").attr("x",(function(e){return s(e.key)})).attr("y",(function(){return 0})).attr("width",s.bandwidth()).attr("height",(function(){return i.height})).attr("fill",(function(e){return c(e.key)})).style("opacity",0).on("mouseover",(function(e,n){v.html("\n        <div>\n          <p>Label: ".concat(n.label,"</p>\n          <p>Count: ").concat((0,y.uf)(n.value),"</p>\n        </div>\n      ")).transition().duration(500).style("visibility","visible"),P.Ys(this).style("fill","var(--chakra-colors-gray-500)").style("opacity",.3)})).on("mousemove",(function(e){v.style("top","".concat(e.pageY-10,"px")).style("left","".concat(e.pageX+10,"px"))})).on("mouseout",(function(){v.html("").transition().duration(500).style("visibility","hidden"),P.Ys(this).style("opacity",0)})),function(){e.select("svg").remove()}}}),[t,i,n])}({target:t,data:n,dimensions:(0,O.y)(i)}),(0,g.jsx)(s.kC,{className:"chart",width:"100%",ref:i,children:(0,g.jsxs)("svg",{width:"100%",overflow:"visible",ref:t,children:[(0,g.jsx)("g",{className:"x-axis"}),(0,g.jsx)("g",{className:"y-axis"})]})})}var N=t(709),$=t(511),E=t(8662),I=function(e){var n,t,i,l,r=e.baseColumn,a=e.targetColumn,o="-",d=r||a;return(0,Z.h5)(Z.a$.safeParse(r)),(0,Z.h5)(Z.a$.safeParse(a)),(0,g.jsx)(s.kC,{direction:"column",gap:2,minH:"250px",children:(0,g.jsxs)(s.kC,{direction:"column",gap:3,children:[(0,g.jsxs)(s.kC,{justifyContent:"space-between",children:[(0,g.jsxs)(s.xv,{maxWidth:"calc(100% - 250px)",children:[(0,g.jsx)(s.xv,{as:"span",fontWeight:700,color:"gray.900",fontSize:"lg",mr:1,noOfLines:1,title:null===d||void 0===d?void 0:d.name,children:null===d||void 0===d?void 0:d.name}),"","(",(0,g.jsx)(s.EK,{children:null===d||void 0===d?void 0:d.schema_type}),")"]}),(0,g.jsxs)(s.kC,{gap:8,children:[(0,g.jsx)(s.xv,{fontWeight:700,textAlign:"right",width:"100px",children:"Base"}),(0,g.jsx)(s.xv,{fontWeight:700,textAlign:"right",width:"100px",children:"Target"})]})]}),(0,g.jsx)(s.kC,{direction:"column",mt:3,children:(0,g.jsx)(N.H,{baseColumn:r,targetColumn:a||null})}),"numeric"===(null===r||void 0===r?void 0:r.type)&&(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(E.D,{baseColumn:r,targetColumn:a||null})}),"datetime"===(null===r||void 0===r?void 0:r.type)&&(0,g.jsxs)(s.kC,{direction:"column",children:[(0,g.jsx)($.$,{name:"Min",firstSlot:null!==(n=null===r||void 0===r?void 0:r.min)&&void 0!==n?n:o,secondSlot:null!==(t=null===a||void 0===a?void 0:a.min)&&void 0!==t?t:o}),(0,g.jsx)($.$,{name:"Max",firstSlot:null!==(i=null===r||void 0===r?void 0:r.max)&&void 0!==i?i:o,secondSlot:null!==(l=null===a||void 0===a?void 0:a.max)&&void 0!==l?l:o})]})]})})};function L(e){var n=e.baseTable,t=e.targetTable;(0,Z.h5)(Z.vT.safeParse(n)),(0,Z.h5)(Z.vT.safeParse(t));var i=(0,_.WN)(null===n||void 0===n?void 0:n.columns,null===t||void 0===t?void 0:t.columns);return(0,g.jsx)(g.Fragment,{children:Object.entries(i).map((function(e){var n=(0,l.Z)(e,2),t=n[0],i=n[1];return(0,g.jsx)(z,{name:t,base:null===i||void 0===i?void 0:i.base,target:null===i||void 0===i?void 0:i.target},t)}))})}function z(e){var n=e.name,t=e.base,i=e.target,r=(0,c.useState)([]),a=(0,l.Z)(r,2),o=a[0],d=a[1];(0,c.useEffect)((function(){if((null===t||void 0===t?void 0:t.type)!==(null===i||void 0===i?void 0:i.type)||"string"!==(null===t||void 0===t?void 0:t.type)&&"datetime"!==(null===t||void 0===t?void 0:t.type)){var e=null!==t&&void 0!==t&&t.distribution?(0,_.Fo)({baseCounts:t.distribution.counts,baseLabels:t.distribution.labels}):null,n=null!==i&&void 0!==i&&i.distribution?(0,_.Fo)({baseCounts:i.distribution.counts,baseLabels:i.distribution.labels}):null;d([e,n])}else{var l=(0,_.NN)({base:null===t||void 0===t?void 0:t.distribution,target:null===i||void 0===i?void 0:i.distribution});d([l])}}),[t,i]);var u=1===o.length;return(0,g.jsx)(s.kC,{direction:"column",children:(0,g.jsxs)(s.rj,{my:8,templateColumns:"500px 1fr",gap:12,children:[(0,g.jsx)(I,{baseColumn:t,targetColumn:i}),(0,g.jsxs)(s.rj,{my:4,templateColumns:"1fr ".concat(u?"":"1fr"),gap:u?0:12,children:[o[0]?(0,g.jsx)(W,{data:o[0]}):(0,g.jsx)(F,{}),o[1]?(0,g.jsx)(W,{data:o[1]}):u?null:(0,g.jsx)(F,{})]})]})},n)}function F(){return(0,g.jsx)(s.kC,{alignItems:"center",justifyContent:"center",color:"gray.500",children:"No data available"})}var D=t(2982),G=t(5984),M=function(e,n){return e?Object.entries(e).map((function(e){var t=(0,l.Z)(e,2),r=t[0],s=t[1];return(0,i.Z)((0,i.Z)({},s),{},{key:r,type:n,changed:!1})})):[]};function R(e){var n=e.base,t=e.target;(0,Z.h5)(Z.vT.safeParse(n)),(0,Z.h5)(Z.vT.safeParse(t));var l="-",r=M(null===n||void 0===n?void 0:n.columns,"base"),a=M(null===t||void 0===t?void 0:t.columns,"target"),o=[].concat((0,D.Z)(r),(0,D.Z)(a)),d=a.length-r.length,c=d<0?0:d,u=r.length-a.length,v=u<0?0:u,h=o.reduce((function(e,n,t){var l,s,a=t<r.length?t:t-r.length,d=t>=r.length?t:t+r.length,c=(null===(l=o[a])||void 0===l?void 0:l.schema_type)!==(null===(s=o[d])||void 0===s?void 0:s.schema_type),u=e.changed+(c?1:0),v=(0,i.Z)((0,i.Z)({},n),{},{name:n.name,changed:c});return(0,i.Z)((0,i.Z)({},e),{},{changed:u,columns:[].concat((0,D.Z)(e.columns),[v])})}),{added:c,deleted:v,changed:0,columns:[]}),x=h.added,f=h.deleted,j=h.changed,m=h.columns,b=m.slice(0,r.length),T=m.slice(r.length),y=V(b,T,d),C=V(T,b,u);return(0,g.jsxs)(s.kC,{direction:"column",children:[(0,g.jsxs)(s.xv,{mb:4,p:2,children:["Added:",(0,g.jsx)(s.xv,{as:"span",fontWeight:700,ml:1,children:x}),", Deleted:",(0,g.jsx)(s.xv,{as:"span",fontWeight:700,ml:1,children:f}),", Changed:"," ",(0,g.jsx)(s.xv,{as:"span",fontWeight:700,ml:1,children:j})]}),(0,g.jsxs)(s.kC,{justifyContent:"space-evenly",children:[(0,g.jsx)(p.xJ,{width:"50%",children:(0,g.jsxs)(p.iA,{variant:"simple",children:[(0,g.jsx)(p.hr,{children:(0,g.jsxs)(p.Tr,{children:[(0,g.jsx)(p.Th,{children:"Column"}),(0,g.jsx)(p.Th,{children:"Type"})]})}),(0,g.jsx)(p.p3,{children:y.map((function(e){var n,t;return(0,g.jsxs)(p.Tr,{color:null!==e&&void 0!==e&&e.changed?"red.500":"inherit",children:[(0,g.jsx)(p.Td,{children:null!==(n=null===e||void 0===e?void 0:e.name)&&void 0!==n?n:l}),(0,g.jsx)(p.Td,{children:null!==(t=null===e||void 0===e?void 0:e.schema_type)&&void 0!==t?t:l})]},(0,G.x0)(10))}))})]})}),(0,g.jsx)(s.kC,{justifyContent:"center",children:(0,g.jsx)(s.iz,{orientation:"vertical"})}),(0,g.jsx)(p.xJ,{width:"50%",children:(0,g.jsxs)(p.iA,{variant:"simple",children:[(0,g.jsx)(p.hr,{children:(0,g.jsxs)(p.Tr,{children:[(0,g.jsx)(p.Th,{children:"Column"}),(0,g.jsx)(p.Th,{children:"Type"})]})}),(0,g.jsx)(p.p3,{children:C.map((function(e){var n,t;return(0,g.jsxs)(p.Tr,{color:null!==e&&void 0!==e&&e.changed?"red.500":"inherit",children:[(0,g.jsx)(p.Td,{children:null!==(n=null===e||void 0===e?void 0:e.name)&&void 0!==n?n:l}),(0,g.jsx)(p.Td,{children:null!==(t=null===e||void 0===e?void 0:e.schema_type)&&void 0!==t?t:l})]},(0,G.x0)(10))}))})]})})]})]})}function V(e,n,t){return e.length<n.length?[].concat((0,D.Z)(e),(0,D.Z)(Array(t).fill(null))):e}var Y=t(8444),B=t.n(Y),X=["base","target"];function J(e){var n=e.base,t=void 0===n?[]:n,i=e.target,l=void 0===i?[]:i,r=(0,f.Z)(e,X),a=B()([].concat((0,D.Z)(t),(0,D.Z)(l)),(function(e){return"".concat(e.level,"_").concat(e.column,"_").concat(e.name)})),o=Object.values(a).map((function(e){var n={level:e[0].level,column:e[0].column,name:e[0].name};return e.forEach((function(e){"base"===e.from?n.base=e:n.target=e})),n}));return 0===o.length?(0,g.jsx)(s.kC,{direction:"column",children:(0,g.jsx)(s.xv,{textAlign:"center",children:"No tests available"})}):(0,g.jsx)(p.xJ,{children:(0,g.jsxs)(p.iA,{variant:"simple",children:[(0,g.jsx)(p.hr,{children:(0,g.jsxs)(p.Tr,{children:[(0,g.jsx)(p.Th,{children:"Level"}),(0,g.jsx)(p.Th,{children:"Column"}),(0,g.jsx)(p.Th,{children:"Assertion"}),(0,g.jsx)(p.Th,{children:"Base Status"}),(0,g.jsx)(p.Th,{children:"Target Status"}),(0,g.jsx)(p.Th,{})]})}),(0,g.jsx)(p.p3,{children:Object.values(o).map((function(e){var n,t;return(0,g.jsxs)(p.Tr,{children:[(0,g.jsx)(p.Td,{children:e.level}),(0,g.jsx)(p.Td,{children:e.column}),(0,g.jsx)(p.Td,{children:e.name}),(0,g.jsx)(p.Td,{children:(0,g.jsx)(b,{status:null===(n=e.base)||void 0===n?void 0:n.status})}),(0,g.jsx)(p.Td,{children:(0,g.jsx)(b,{status:null===(t=e.target)||void 0===t?void 0:t.status})}),(0,g.jsx)(p.Td,{onClick:function(){r.onDetailVisible(e)},children:(0,g.jsx)(s.xv,{as:"span",cursor:"pointer",children:"\ud83d\udd0d"})})]},(0,G.x0)())}))})]})})}function K(e){var n,t,i,l,r,a,o=e.baseTable,d=e.targetTable;(0,Z.h5)(Z.vT.safeParse(o)),(0,Z.h5)(Z.vT.safeParse(d));var c=(0,v.YI)(null===o||void 0===o?void 0:o.piperider_assertion_result,null===o||void 0===o?void 0:o.dbt_assertion_result),u=(0,v.YI)(null===d||void 0===d?void 0:d.piperider_assertion_result,null===d||void 0===d?void 0:d.dbt_assertion_result);return(0,g.jsx)(p.xJ,{children:(0,g.jsxs)(p.iA,{variant:"simple",children:[(0,g.jsx)(p.hr,{children:(0,g.jsxs)(p.Tr,{children:[(0,g.jsx)(p.Th,{width:"10%"}),(0,g.jsx)(p.Th,{width:"45%",children:"Base"}),(0,g.jsx)(p.Th,{width:"45%",children:"Target"})]})}),(0,g.jsxs)(p.p3,{children:[(0,g.jsxs)(p.Tr,{children:[(0,g.jsx)(p.Td,{children:"Table"}),(0,g.jsx)(p.Td,{children:null!==(n=null===o||void 0===o?void 0:o.name)&&void 0!==n?n:"-"}),(0,g.jsx)(p.Td,{children:null!==(t=null===d||void 0===d?void 0:d.name)&&void 0!==t?t:"-"})]}),(0,g.jsxs)(p.Tr,{children:[(0,g.jsx)(p.Td,{children:"Rows"}),(0,g.jsx)(p.Td,{children:null!==(i=null===o||void 0===o?void 0:o.row_count)&&void 0!==i?i:"-"}),(0,g.jsx)(p.Td,{children:null!==(l=null===d||void 0===d?void 0:d.row_count)&&void 0!==l?l:"-"})]}),(0,g.jsxs)(p.Tr,{children:[(0,g.jsx)(p.Td,{children:"Columns"}),(0,g.jsx)(p.Td,{children:null!==(r=null===o||void 0===o?void 0:o.col_count)&&void 0!==r?r:"-"}),(0,g.jsx)(p.Td,{children:null!==(a=null===d||void 0===d?void 0:d.col_count)&&void 0!==a?a:"-"})]}),(0,g.jsxs)(p.Tr,{children:[(0,g.jsx)(p.Td,{children:"Test status"}),(0,g.jsx)(p.Td,{children:(0,g.jsxs)(s.xv,{children:[(0,g.jsxs)(s.xv,{as:"span",fontWeight:700,children:[c.passed," "]}),"Passed",", ",(0,g.jsxs)(s.xv,{as:"span",fontWeight:700,color:c.failed>0?"red.500":"inherit",children:[c.failed," "]}),"Failed"]})}),(0,g.jsx)(p.Td,{children:(0,g.jsxs)(s.xv,{children:[(0,g.jsxs)(s.xv,{as:"span",fontWeight:700,children:[u.passed," "]}),"Passed",", ",(0,g.jsxs)(s.xv,{as:"span",fontWeight:700,color:u.failed>0?"red.500":"inherit",children:[u.failed," "]}),"Failed"]})})]})]})]})})}function H(e){var n,t=e.data,f=e.name,j=(0,c.useState)(null),m=(0,l.Z)(j,2),p=m[0],b=m[1],T=(0,r.qY)(),y=t.base,C=t.input;(0,Z.h5)((0,Z.C6)(!0).safeParse(t));var k=y.tables[f],_=C.tables[f],O=null===(n=y.tables[f])||void 0===n?void 0:n.dbt_assertion_result;(0,Z.h5)(Z.vT.safeParse(k)),(0,Z.h5)(Z.vT.safeParse(_));var P=(0,v.Ix)({data:t,reportName:f,type:"piperider"}),w=(0,l.Z)(P,2),A=w[0],W=w[1],N=(0,v.Ix)({data:t,reportName:f,type:"dbt"}),$=(0,l.Z)(N,2),E=$[0],I=$[1];return(0,h.j)(f),(0,g.jsxs)(u.o,{children:[(0,g.jsxs)(s.kC,{direction:"column",minH:"calc(100vh + 1px)",width:"100%",children:[(0,g.jsx)(s.kC,{mx:"10%",mt:4,children:(0,g.jsxs)(a.aG,{fontSize:"lg",children:[(0,g.jsx)(a.gN,{children:(0,g.jsx)(d.rU,{href:"/",children:(0,g.jsx)(a.At,{href:"/","data-cy":"cr-report-breadcrumb-back",children:"Tables"})})}),(0,g.jsx)(a.gN,{isCurrentPage:!0,children:(0,g.jsx)(a.At,{href:"#",children:f})})]})}),(0,g.jsxs)(s.kC,{border:"1px solid",borderColor:"gray.300",bg:"white",borderRadius:"md",p:6,mt:3,mx:"10%",direction:"column",gap:8,children:[(0,g.jsx)(s.X6,{fontSize:24,children:"Overview"}),(0,g.jsx)(K,{baseTable:k,targetTable:_}),(0,g.jsxs)(o.mQ,{isLazy:!0,children:[(0,g.jsxs)(o.td,{children:[(0,g.jsx)(o.OK,{onClick:function(){(0,x._)({eventName:x.X.PAGE_VIEW,eventProperties:{type:"comparison-report",tab:"Schema"}})},children:"Schema"}),(0,g.jsx)(o.OK,{"data-cy":"cr-report-tab-item-profiling",onClick:function(){(0,x._)({eventName:x.X.PAGE_VIEW,eventProperties:{type:"comparison-report",tab:"Profiling"}})},children:"Profiling"}),(0,g.jsx)(o.OK,{"data-cy":"cr-report-tab-item-tests",onClick:function(){(0,x._)({eventName:x.X.PAGE_VIEW,eventProperties:{type:"comparison-report",tab:"Tests"}})},children:"Tests"}),O&&(0,g.jsx)(o.OK,{onClick:function(){(0,x._)({eventName:x.X.PAGE_VIEW,eventProperties:{type:"comparison-report",tab:"dbt Tests"}})},children:"dbt Tests"})]}),(0,g.jsxs)(o.nP,{children:[(0,g.jsx)(o.x4,{children:(0,g.jsx)(R,{base:k,target:_})}),(0,g.jsx)(o.x4,{children:(0,g.jsx)(L,{baseTable:k,targetTable:_})}),(0,g.jsx)(o.x4,{children:(0,g.jsx)(J,{base:null===A||void 0===A?void 0:A.tests,target:null===W||void 0===W?void 0:W.tests,onDetailVisible:function(e){b({type:"piperider",data:e}),T.onOpen()}})}),(0,g.jsx)(o.x4,{children:0===(null===E||void 0===E?void 0:E.tests.length)&&0===(null===I||void 0===I?void 0:I.tests.length)?(0,g.jsx)(s.kC,{justifyContent:"center",alignItems:"center",height:"100px",children:(0,g.jsx)(s.xv,{color:"gray.500",children:"No dbt tests available."})}):(0,g.jsx)(J,{base:null===E||void 0===E?void 0:E.tests,target:null===I||void 0===I?void 0:I.tests,onDetailVisible:function(e){b({type:"dbt",data:e}),T.onOpen()}})})]})]})]})]}),(0,g.jsx)(S,(0,i.Z)((0,i.Z)({},T),{},{type:null===p||void 0===p?void 0:p.type,data:null===p||void 0===p?void 0:p.data,onClose:function(){T.onClose(),b(null)}}))]})}},709:function(e,n,t){t.d(n,{H:function(){return o}});var i=t(6523),l=t(1971),r=t(922),s=t(511),a=t(184);function o(e){var n=e.baseColumn,t=e.targetColumn;if(n){(0,i.h5)(i.a$.safeParse(n));var o=(0,r.gQ)(n),d=o.totalOfTotal,c=o.valid,u=o.total,v=o.mismatch,h=o.missing,x=o.mismatchOfTotal,f=o.validOfTotal,j=o.missingOfTotal,m=o.distinctOfTotal}if(t){(0,i.h5)(i.a$.safeParse(t));var p=(0,r.gQ)(t),g=p.total,b=p.mismatchOfTotal,T=p.validOfTotal,y=p.missingOfTotal,C=p.distinctOfTotal}var k=null===t,S="-";return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.$,{name:"Total",firstSlot:(0,l.uy)(u,l.uf),secondSlot:k?S:(0,l.uy)(t?g:d,t?l.uf:l.Zn)}),(0,a.jsx)(s.$,{name:"Valid",firstSlot:(0,l.uy)(t?f:c,t?l.Zn:l.uf),secondSlot:k?S:(0,l.uy)(t?T:f,l.Zn)}),(0,a.jsx)(s.$,{name:"Mismatched",firstSlot:(0,l.uy)(t?x:v,t?l.Zn:l.uf),secondSlot:k?S:(0,l.uy)(t?b:x,l.Zn)}),(0,a.jsx)(s.$,{name:"Missing",firstSlot:(0,l.uy)(t?j:h,t?l.Zn:l.uf),secondSlot:k?S:(0,l.uy)(t?y:j,l.Zn)}),(0,a.jsx)(s.$,{name:"Distinct",firstSlot:(0,l.uy)(null===n||void 0===n?void 0:n.distinct,l.uf),secondSlot:k?S:(0,l.uy)(t?C:m,l.Zn)})]})}},511:function(e,n,t){t.d(n,{$:function(){return r}});var i=t(8735),l=t(184);function r(e){var n=e.name,t=e.firstSlot,r=e.secondSlot,s=e.firstSlotWidth,a=void 0===s?"100px":s,o=e.secondSlotWidth,d=void 0===o?"100px":o;return(0,l.jsxs)(i.kC,{justifyContent:"space-between",children:[(0,l.jsx)(i.xv,{fontWeight:700,children:n}),(0,l.jsxs)(i.kC,{gap:{lg:5,md:1},children:[(0,l.jsx)(i.xv,{textAlign:"right",width:a,noOfLines:1,children:t}),r&&(0,l.jsx)(i.xv,{textAlign:"right",width:d,children:r})]})]})}},8662:function(e,n,t){t.d(n,{D:function(){return o}});var i=t(8735),l=t(6523),r=t(1971),s=t(511),a=t(184);function o(e){var n=e.baseColumn,t=e.targetColumn,o=null===t,d=void 0===t,c="-";return(0,l.h5)(l.a$.safeParse(n)),(0,l.h5)(l.a$.safeParse(n)),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(i.kC,{direction:"column",children:[(0,a.jsx)(s.$,{name:"Average",firstSlot:(0,r.uy)(null===n||void 0===n?void 0:n.avg,r.uf),secondSlot:o?c:d?void 0:(0,r.uy)(null===t||void 0===t?void 0:t.avg,r.uf)}),(0,a.jsx)(s.$,{name:"Std. Deviation",firstSlot:(0,r.uy)(null===n||void 0===n?void 0:n.stddev,r.uf),secondSlot:o?c:d?void 0:(0,r.uy)(null===t||void 0===t?void 0:t.stddev,r.uf)})]}),(0,a.jsxs)(i.kC,{direction:"column",children:[(0,a.jsx)(s.$,{name:"Min",firstSlot:(0,r.uy)(null===n||void 0===n?void 0:n.min,r.uf),secondSlot:o?c:d?void 0:(0,r.uy)(null===t||void 0===t?void 0:t.min,r.uf)}),(0,a.jsx)(s.$,{name:"5%",firstSlot:(0,r.uy)(null===n||void 0===n?void 0:n.p5,r.uf),secondSlot:o?c:d?void 0:(0,r.uy)(null===t||void 0===t?void 0:t.p5,r.uf)}),(0,a.jsx)(s.$,{name:"25%",firstSlot:(0,r.uy)(null===n||void 0===n?void 0:n.p25,r.uf),secondSlot:o?c:d?void 0:(0,r.uy)(null===t||void 0===t?void 0:t.p25,r.uf)}),(0,a.jsx)(s.$,{name:"50%",firstSlot:(0,r.uy)(null===n||void 0===n?void 0:n.p50,r.uf),secondSlot:o?c:d?void 0:(0,r.uy)(null===t||void 0===t?void 0:t.p50,r.uf)}),(0,a.jsx)(s.$,{name:"75%",firstSlot:(0,r.uy)(null===n||void 0===n?void 0:n.p75,r.uf),secondSlot:o?c:d?void 0:(0,r.uy)(null===t||void 0===t?void 0:t.p75,r.uf)}),(0,a.jsx)(s.$,{name:"95%",firstSlot:(0,r.uy)(null===n||void 0===n?void 0:n.p95,r.uf),secondSlot:o?c:d?void 0:(0,r.uy)(null===t||void 0===t?void 0:t.p95,r.uf)}),(0,a.jsx)(s.$,{name:"Max",firstSlot:(0,r.uy)(null===n||void 0===n?void 0:n.max,r.uf),secondSlot:o?c:d?void 0:(0,r.uy)(null===t||void 0===t?void 0:t.max,r.uf)})]})]})}},8453:function(e,n,t){t.d(n,{y:function(){return r}});var i=t(885),l=t(2791);function r(e){var n=(0,l.useState)(null),t=(0,i.Z)(n,2),r=t[0],s=t[1];return(0,l.useEffect)((function(){if(e&&e.current){var n=e.current,t=new ResizeObserver((function(e){e.forEach((function(e){s(e.contentRect)}))}));return t.observe(n),function(){t.unobserve(n)}}}),[e]),r}},3442:function(e,n,t){t.d(n,{X:function(){return l},_:function(){return r}});var i=t(8083),l={PAGE_VIEW:"Page View"};function r(e){var n=e.eventName,t=e.eventProperties,l=e.eventOptions;return window.PIPERIDER_METADATA.amplitude_api_key?(0,i.j)(n,t,l):console.info({eventName:n,eventProperties:t,eventOptions:l})}},9842:function(e,n,t){t.d(n,{v:function(){return u}});var i=t(9227),l="var(--chakra-space-2)",r="var(--chakra-space-2)",s="var(--chakra-space-4)",a="var(--chakra-space-4)",o="var(--chakra-radii-md)",d="var(--chakra-colors-white)",c="var(--chakra-colors-blackAlpha-700)";function u(e){var n=e.target,t=e.style,u=void 0===t?{}:t;return i.Ys(n).append("div").style("visibility","hidden").style("position","absolute").style("z-index","9").style("padding-top",(null===u||void 0===u?void 0:u.paddingTop)||l).style("padding-bottom",(null===u||void 0===u?void 0:u.paddingBottom)||r).style("border-radius",(null===u||void 0===u?void 0:u.borderRadius)||o).style("padding-left",(null===u||void 0===u?void 0:u.paddingLeft)||s).style("padding-right",(null===u||void 0===u?void 0:u.paddingRight)||a).style("color",(null===u||void 0===u?void 0:u.color)||d).style("background-color",(null===u||void 0===u?void 0:u.backgroundColor)||c)}},922:function(e,n,t){t.d(n,{Fo:function(){return a},NN:function(){return s},WN:function(){return r},gQ:function(){return o}});var i=t(2982),l=t(885);function r(e,n){var t={};return Object.entries(e||{}).forEach((function(e){var n=(0,l.Z)(e,2),i=n[0],r=n[1];t[i]||(t[i]={}),t[i].base=r})),Object.entries(n||{}).forEach((function(e){var n=(0,l.Z)(e,2),i=n[0],r=n[1];t[i]||(t[i]={}),t[i].target=r})),t}function s(e){var n=e.base,t=e.target,l=new Map;if(!n||!t)return null;var r=n.labels.map((function(e,t){return l.set(e||String(t),t),{label:e,base:n.counts[t],target:0}}));return t.labels.reduce((function(e,n,r){var s=n||String(r),a=l.has(s),o=t.counts[r];if(a)return e[l.get(s)].target=o,e;var d={label:n,base:0,target:o};return[].concat((0,i.Z)(e),[d])}),r)}function a(e){var n=e.baseCounts,t=e.baseLabels;return n.map((function(e,n){return{label:t[n],base:e,target:0}}))}function o(e){var n=e.non_nulls,t=e.total,i=e.nulls||0,l=n-i,r=t-n;return{hasNoNull:n===t,mismatch:i,valid:l,missing:r,distinctOfTotal:e.distinct/t,validOfTotal:l/t,mismatchOfTotal:i/t,missingOfTotal:r/t,totalOfTotal:t/t,total:t}}}}]);
//# sourceMappingURL=826.54ca5e43.chunk.js.map