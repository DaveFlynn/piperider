"use strict";(self.webpackChunkpiperider_report=self.webpackChunkpiperider_report||[]).push([[16],{3016:function(e,n,t){t.r(n),t.d(n,{default:function(){return A}});var i=t(8735),r=t(6837),s=t(4385),a=t(8625),l=t(8011),o=t(2483),d=t(3442),c=t(2791),u=t(8453),v=t(9227),f=t(1971),h=t(9842);var x=t(184);function m(e){var n=e.data,t=(0,c.useRef)(null),r=(0,c.useRef)(null);return function(e){var n=e.target,t=e.data,i=e.dimensions;(0,c.useEffect)((function(){if(n&&i&&t){var e=v.Ys(n.current),r=v.tiA().domain(t.map((function(e){return e.label}))).range([0,i.width]).padding(.05),s=v.LLu(r).tickFormat((function(e,n){var t=r.domain().length-1;return 0===n||n===t/2||n===t?e:null}));e.select(".x-axis").style("transform","translateY(".concat(i.height,"px)")).call(s);var a=v.BYU().domain([0,v.Fp7(t,(function(e){return e.value}))]).range([i.height,0]),l=v.y4O(a);e.select(".y-axis").call(l),e.selectAll(".bar").data(t).join("rect").attr("class","bar").attr("x",(function(e){return r(e.label)})).attr("y",(function(e){return a(e.value)})).attr("width",r.bandwidth()).attr("height",(function(e){return i.height-a(e.value)})).style("fill","var(--chakra-colors-blue-300)");var o=(0,h.v)({target:".chart"});return e.selectAll(".overlay-bars").data(t).join("rect").attr("class","overlay-bars").attr("x",(function(e){return r(e.label)})).attr("y",(function(){return 0})).attr("width",r.bandwidth()).attr("height",(function(){return i.height})).style("opacity",0).on("mouseover",(function(e,n){var t=n,i=t.label,r=t.value,s=t.total;o.html("\n          <div>\n            <p>Label: ".concat(i,"</p>\n            <p>Count: ").concat((0,f.uf)(r),"</p>\n            <p>Percentage: ").concat(Number(r/s*100).toFixed(3),"%</p>\n          </div>\n        ")).transition().duration(500).style("visibility","visible"),v.Ys(this).style("fill","var(--chakra-colors-gray-500)").style("opacity",.3)})).on("mousemove",(function(e){o.style("top","".concat(e.pageY-10,"px")).style("left","".concat(e.pageX+10,"px"))})).on("mouseout",(function(){o.html("").transition().duration(500).style("visibility","hidden"),v.Ys(this).style("opacity",0)})),function(){e.select("svg").remove()}}}),[n,i,t])}({target:t,data:n,dimensions:(0,u.y)(r)}),(0,x.jsx)(i.kC,{className:"chart",width:"100%",ref:r,children:(0,x.jsxs)("svg",{width:"100%",overflow:"visible",ref:t,children:[(0,x.jsx)("g",{className:"x-axis"}),(0,x.jsx)("g",{className:"y-axis"})]})})}var p=t(511),j=t(5272),g=t(8662),y=t(709),b=t(8853),T=t(6523),S=function(e){var n=e.column;return(0,T.h5)(T.a$.safeParse(n)),(0,x.jsxs)(i.kC,{direction:"column",gap:3,children:[(0,x.jsxs)(i.xu,{maxWidth:"100%",children:[(0,x.jsxs)(i.kC,{children:[(0,x.jsx)(i.xv,{as:"span",fontWeight:700,color:"gray.900",fontSize:"lg",mr:1,title:n.name,noOfLines:1,children:n.name}),(0,x.jsx)(b.l,{label:n.description,prefix:" - via ",placement:"right-end",children:(0,x.jsx)(j.hQ,{m:"auto 0"})})]}),"","(",(0,x.jsx)(i.EK,{children:n.schema_type}),")"]}),(0,x.jsx)(i.kC,{direction:"column",mt:3,children:(0,x.jsx)(y.H,{baseColumn:n})}),"string"===n.type&&n.distribution&&(0,x.jsx)(i.kC,{direction:"column",children:(0,x.jsx)(p.$,{name:"Most common",firstSlot:(0,f.qW)(n),firstSlotWidth:"200px"})}),"numeric"===n.type&&(0,x.jsx)(g.D,{baseColumn:n}),"datetime"===n.type&&(0,x.jsxs)(i.kC,{direction:"column",children:[(0,x.jsx)(p.$,{name:"Min",firstSlot:n.min}),(0,x.jsx)(p.$,{name:"Max",firstSlot:n.max})]})]})};function k(e){var n=e.data;return(0,x.jsx)(i.kC,{direction:"column",gap:4,children:Object.keys(n).map((function(e){var t=n[e];(0,T.h5)(T.a$.safeParse(t));var r=t.distribution;return(0,x.jsxs)(i.kC,{direction:"column",px:4,children:[(0,x.jsxs)(i.rj,{my:4,templateColumns:"minmax(270px, 1fr) 1fr",gap:12,children:[(0,x.jsx)(S,{column:t}),(0,x.jsx)(i.kC,{mt:8,justifyContent:"center",alignItems:"center",children:r?(0,x.jsx)(m,{data:r.labels.map((function(e,n){return{label:e,value:r.counts[n],total:t.total}}))}):(0,x.jsx)(i.xv,{children:"No data available"})})]}),(0,x.jsx)(i.iz,{my:4})]},e)}))})}var C=t(7005),O=t(4821),P=t(874);function _(e){var n=e.assertionData,t=e.type,r=void 0===t?"piperider":t,s=null===n||void 0===n?void 0:n.tests,a=(null===n||void 0===n?void 0:n.columns)||{};return!s||0===s.length&&0===Object.keys(a).length?(0,x.jsx)(i.kC,{direction:"column",children:(0,x.jsx)(i.xv,{textAlign:"center",children:"No tests available"})}):(0,x.jsx)(i.kC,{direction:"column",gap:4,children:(0,x.jsx)(C.xJ,{children:(0,x.jsxs)(C.iA,{variant:"simple",children:[(0,x.jsx)(C.hr,{children:(0,x.jsxs)(C.Tr,{children:[(0,x.jsx)(C.Th,{children:"Level"}),(0,x.jsx)(C.Th,{children:"Column"}),(0,x.jsx)(C.Th,{children:"Assertion"}),(0,x.jsx)(C.Th,{children:"Status"}),"piperider"===r&&(0,x.jsx)(C.Th,{children:"Expected"}),"piperider"===r&&(0,x.jsx)(C.Th,{children:"Actual"})]})}),(0,x.jsxs)(C.p3,{children:[s.map((function(e){(0,T.h5)(O.S1.safeParse(e));var n="failed"===e.status;return(0,x.jsxs)(C.Tr,{children:[(0,x.jsx)(C.Td,{children:"Table"}),(0,x.jsx)(C.Td,{children:"-"}),(0,x.jsx)(C.Td,{children:e.name}),(0,x.jsx)(C.Td,{children:n?(0,x.jsx)(i.xv,{as:"span",role:"img",children:"\u274c"}):(0,x.jsx)(i.xv,{as:"span",role:"img",children:"\u2705"})}),"piperider"===r&&(0,x.jsx)(C.Td,{children:(0,f.sG)(e.expected)}),"piperider"===r&&(0,x.jsx)(C.Td,{color:n?"red.500":"inherit",children:(0,f.sG)(e.actual)})]},e.name)})),Object.keys(a).map((function(e){var n=a[e];return(0,T.h5)(P.z.array(O.S1).safeParse(n)),n.map((function(n){var t="failed"===n.status;return(0,x.jsxs)(C.Tr,{children:[(0,x.jsx)(C.Td,{children:"Column"}),(0,x.jsx)(C.Td,{children:e}),(0,x.jsx)(C.Td,{children:n.name}),(0,x.jsx)(C.Td,{children:t?(0,x.jsx)(i.xv,{as:"span",role:"img",children:"\u274c"}):(0,x.jsx)(i.xv,{as:"span",role:"img",children:"\u2705"})}),"piperider"===r&&(0,x.jsx)(C.Td,{children:(0,f.sG)(n.expected)}),"piperider"===r&&(0,x.jsx)(C.Td,{color:t?"red.500":"inherit",children:(0,f.sG)(n.actual)})]},n.name)}))}))]})]})})})}var w=t(6157);function $(e){var n=e.table;(0,T.h5)(T.vT.safeParse(n));var t=(0,w.YI)(n.piperider_assertion_result,n.dbt_assertion_result);return(0,x.jsxs)(i.kC,{direction:"column",gap:4,mb:8,children:[(0,x.jsx)(i.X6,{size:"lg",children:"Overview"}),(0,x.jsxs)(i.xv,{children:["Table:"," ",(0,x.jsx)(i.xv,{as:"span",fontWeight:700,children:n.name})]}),(0,x.jsxs)(i.xv,{children:["Rows:"," ",(0,x.jsx)(i.xv,{as:"span",fontWeight:700,children:(0,f.uf)(n.row_count)})]}),(0,x.jsxs)(i.xv,{children:["Columns:"," ",(0,x.jsx)(i.xv,{as:"span",fontWeight:700,children:(0,f.uf)(n.col_count)})]}),(0,x.jsxs)(i.xv,{children:["Test Status:"," ",(0,x.jsx)(i.xv,{as:"span",fontWeight:700,children:t.passed})," ","Passed,"," ",(0,x.jsx)(i.xv,{as:"span",fontWeight:700,color:t.failed>0?"red.500":"inherit",children:t.failed})," ","Failed"]})]})}function A(e){var n=e.data,t=e.name,c=n.datasource,u=n.tables[t];return(0,T.h5)(T.vT.safeParse(u)),(0,T.h5)(O.U0.safeParse(c)),(0,o.j)(t),n?(0,x.jsx)(l.o,{children:(0,x.jsxs)(i.kC,{direction:"column",minH:"calc(100vh + 1px)",width:"100%",children:[(0,x.jsx)(i.kC,{mx:"10%",mt:4,children:(0,x.jsxs)(r.aG,{fontSize:"lg",children:[(0,x.jsx)(r.gN,{children:(0,x.jsx)(a.rU,{href:"/",children:(0,x.jsx)(r.At,{href:"/","data-cy":"sr-report-breadcrumb-back",children:c.name})})}),(0,x.jsx)(r.gN,{isCurrentPage:!0,children:(0,x.jsx)(r.At,{href:"#",children:u.name})})]})}),(0,x.jsxs)(i.kC,{border:"1px solid",borderColor:"gray.300",bg:"white",borderRadius:"md",p:6,mt:3,mx:"10%",direction:"column",children:[(0,x.jsx)($,{table:u}),(0,x.jsxs)(s.mQ,{isLazy:!0,children:[(0,x.jsxs)(s.td,{children:[(0,x.jsx)(s.OK,{onClick:function(){(0,d._)({eventName:d.X.PAGE_VIEW,eventProperties:{type:"single-report",tab:"Profiling"}})},children:"Profiling"}),(0,x.jsx)(s.OK,{"data-cy":"sr-report-tab-item",onClick:function(){(0,d._)({eventName:d.X.PAGE_VIEW,eventProperties:{type:"single-report",tab:"Tests"}})},children:"Tests"}),u.dbt_assertion_result&&(0,x.jsx)(s.OK,{onClick:function(){(0,d._)({eventName:d.X.PAGE_VIEW,eventProperties:{type:"single-report",tab:"dbt Tests"}})},children:"dbt Tests"})]}),(0,x.jsxs)(s.nP,{children:[(0,x.jsx)(s.x4,{children:(0,x.jsx)(k,{data:u.columns})}),(0,x.jsx)(s.x4,{children:(0,x.jsx)(_,{assertionData:u.piperider_assertion_result})}),(null===u||void 0===u?void 0:u.dbt_assertion_result)&&(0,x.jsx)(s.x4,{children:(0,x.jsx)(_,{type:"dbt",assertionData:u.dbt_assertion_result})})]})]})]})]})}):(0,x.jsx)(l.o,{children:(0,x.jsx)(i.kC,{justifyContent:"center",alignItems:"center",minHeight:"100vh",children:"No profile data found."})})}},709:function(e,n,t){t.d(n,{H:function(){return o}});var i=t(6523),r=t(1971),s=t(922),a=t(511),l=t(184);function o(e){var n=e.baseColumn,t=e.targetColumn;if(n){(0,i.h5)(i.a$.safeParse(n));var o=(0,s.gQ)(n),d=o.totalOfTotal,c=o.valid,u=o.total,v=o.mismatch,f=o.missing,h=o.mismatchOfTotal,x=o.validOfTotal,m=o.missingOfTotal,p=o.distinctOfTotal}if(t){(0,i.h5)(i.a$.safeParse(t));var j=(0,s.gQ)(t),g=j.total,y=j.mismatchOfTotal,b=j.validOfTotal,T=j.missingOfTotal,S=j.distinctOfTotal}var k=null===t,C="-";return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.$,{name:"Total",firstSlot:(0,r.uy)(u,r.uf),secondSlot:k?C:(0,r.uy)(t?g:d,t?r.uf:r.Zn)}),(0,l.jsx)(a.$,{name:"Valid",firstSlot:(0,r.uy)(t?x:c,t?r.Zn:r.uf),secondSlot:k?C:(0,r.uy)(t?b:x,r.Zn)}),(0,l.jsx)(a.$,{name:"Mismatched",firstSlot:(0,r.uy)(t?h:v,t?r.Zn:r.uf),secondSlot:k?C:(0,r.uy)(t?y:h,r.Zn)}),(0,l.jsx)(a.$,{name:"Missing",firstSlot:(0,r.uy)(t?m:f,t?r.Zn:r.uf),secondSlot:k?C:(0,r.uy)(t?T:m,r.Zn)}),(0,l.jsx)(a.$,{name:"Distinct",firstSlot:(0,r.uy)(null===n||void 0===n?void 0:n.distinct,r.uf),secondSlot:k?C:(0,r.uy)(t?S:p,r.Zn)})]})}},511:function(e,n,t){t.d(n,{$:function(){return s}});var i=t(8735),r=t(184);function s(e){var n=e.name,t=e.firstSlot,s=e.secondSlot,a=e.firstSlotWidth,l=void 0===a?"100px":a,o=e.secondSlotWidth,d=void 0===o?"100px":o;return(0,r.jsxs)(i.kC,{justifyContent:"space-between",children:[(0,r.jsx)(i.xv,{fontWeight:700,children:n}),(0,r.jsxs)(i.kC,{gap:{lg:5,md:1},children:[(0,r.jsx)(i.xv,{textAlign:"right",width:l,noOfLines:1,children:t}),s&&(0,r.jsx)(i.xv,{textAlign:"right",width:d,children:s})]})]})}},8662:function(e,n,t){t.d(n,{D:function(){return o}});var i=t(8735),r=t(6523),s=t(1971),a=t(511),l=t(184);function o(e){var n=e.baseColumn,t=e.targetColumn,o=null===t,d=void 0===t,c="-";return(0,r.h5)(r.a$.safeParse(n)),(0,r.h5)(r.a$.safeParse(n)),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(i.kC,{direction:"column",children:[(0,l.jsx)(a.$,{name:"Average",firstSlot:(0,s.uy)(null===n||void 0===n?void 0:n.avg,s.uf),secondSlot:o?c:d?void 0:(0,s.uy)(null===t||void 0===t?void 0:t.avg,s.uf)}),(0,l.jsx)(a.$,{name:"Std. Deviation",firstSlot:(0,s.uy)(null===n||void 0===n?void 0:n.stddev,s.uf),secondSlot:o?c:d?void 0:(0,s.uy)(null===t||void 0===t?void 0:t.stddev,s.uf)})]}),(0,l.jsxs)(i.kC,{direction:"column",children:[(0,l.jsx)(a.$,{name:"Min",firstSlot:(0,s.uy)(null===n||void 0===n?void 0:n.min,s.uf),secondSlot:o?c:d?void 0:(0,s.uy)(null===t||void 0===t?void 0:t.min,s.uf)}),(0,l.jsx)(a.$,{name:"5%",firstSlot:(0,s.uy)(null===n||void 0===n?void 0:n.p5,s.uf),secondSlot:o?c:d?void 0:(0,s.uy)(null===t||void 0===t?void 0:t.p5,s.uf)}),(0,l.jsx)(a.$,{name:"25%",firstSlot:(0,s.uy)(null===n||void 0===n?void 0:n.p25,s.uf),secondSlot:o?c:d?void 0:(0,s.uy)(null===t||void 0===t?void 0:t.p25,s.uf)}),(0,l.jsx)(a.$,{name:"50%",firstSlot:(0,s.uy)(null===n||void 0===n?void 0:n.p50,s.uf),secondSlot:o?c:d?void 0:(0,s.uy)(null===t||void 0===t?void 0:t.p50,s.uf)}),(0,l.jsx)(a.$,{name:"75%",firstSlot:(0,s.uy)(null===n||void 0===n?void 0:n.p75,s.uf),secondSlot:o?c:d?void 0:(0,s.uy)(null===t||void 0===t?void 0:t.p75,s.uf)}),(0,l.jsx)(a.$,{name:"95%",firstSlot:(0,s.uy)(null===n||void 0===n?void 0:n.p95,s.uf),secondSlot:o?c:d?void 0:(0,s.uy)(null===t||void 0===t?void 0:t.p95,s.uf)}),(0,l.jsx)(a.$,{name:"Max",firstSlot:(0,s.uy)(null===n||void 0===n?void 0:n.max,s.uf),secondSlot:o?c:d?void 0:(0,s.uy)(null===t||void 0===t?void 0:t.max,s.uf)})]})]})}},8453:function(e,n,t){t.d(n,{y:function(){return s}});var i=t(885),r=t(2791);function s(e){var n=(0,r.useState)(null),t=(0,i.Z)(n,2),s=t[0],a=t[1];return(0,r.useEffect)((function(){if(e&&e.current){var n=e.current,t=new ResizeObserver((function(e){e.forEach((function(e){a(e.contentRect)}))}));return t.observe(n),function(){t.unobserve(n)}}}),[e]),s}},3442:function(e,n,t){t.d(n,{X:function(){return r},_:function(){return s}});var i=t(8083),r={PAGE_VIEW:"Page View"};function s(e){var n=e.eventName,t=e.eventProperties,r=e.eventOptions;return window.PIPERIDER_METADATA.amplitude_api_key?(0,i.j)(n,t,r):console.info({eventName:n,eventProperties:t,eventOptions:r})}},9842:function(e,n,t){t.d(n,{v:function(){return u}});var i=t(9227),r="var(--chakra-space-2)",s="var(--chakra-space-2)",a="var(--chakra-space-4)",l="var(--chakra-space-4)",o="var(--chakra-radii-md)",d="var(--chakra-colors-white)",c="var(--chakra-colors-blackAlpha-700)";function u(e){var n=e.target,t=e.style,u=void 0===t?{}:t;return i.Ys(n).append("div").style("visibility","hidden").style("position","absolute").style("z-index","9").style("padding-top",(null===u||void 0===u?void 0:u.paddingTop)||r).style("padding-bottom",(null===u||void 0===u?void 0:u.paddingBottom)||s).style("border-radius",(null===u||void 0===u?void 0:u.borderRadius)||o).style("padding-left",(null===u||void 0===u?void 0:u.paddingLeft)||a).style("padding-right",(null===u||void 0===u?void 0:u.paddingRight)||l).style("color",(null===u||void 0===u?void 0:u.color)||d).style("background-color",(null===u||void 0===u?void 0:u.backgroundColor)||c)}},922:function(e,n,t){t.d(n,{Fo:function(){return l},NN:function(){return a},WN:function(){return s},gQ:function(){return o}});var i=t(2982),r=t(885);function s(e,n){var t={};return Object.entries(e||{}).forEach((function(e){var n=(0,r.Z)(e,2),i=n[0],s=n[1];t[i]||(t[i]={}),t[i].base=s})),Object.entries(n||{}).forEach((function(e){var n=(0,r.Z)(e,2),i=n[0],s=n[1];t[i]||(t[i]={}),t[i].target=s})),t}function a(e){var n=e.base,t=e.target,r=new Map;if(!n||!t)return null;var s=n.labels.map((function(e,t){return r.set(e||String(t),t),{label:e,base:n.counts[t],target:0}}));return t.labels.reduce((function(e,n,s){var a=n||String(s),l=r.has(a),o=t.counts[s];if(l)return e[r.get(a)].target=o,e;var d={label:n,base:0,target:o};return[].concat((0,i.Z)(e),[d])}),s)}function l(e){var n=e.baseCounts,t=e.baseLabels;return n.map((function(e,n){return{label:t[n],base:e,target:0}}))}function o(e){var n=e.non_nulls,t=e.total,i=e.nulls||0,r=n-i,s=t-n;return{hasNoNull:n===t,mismatch:i,valid:r,missing:s,distinctOfTotal:e.distinct/t,validOfTotal:r/t,mismatchOfTotal:i/t,missingOfTotal:s/t,totalOfTotal:t/t,total:t}}}}]);
//# sourceMappingURL=16.942b09fb.chunk.js.map